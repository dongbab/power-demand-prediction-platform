<!DOCTYPE html>
<html lang="ko">
<head>
    <title>⚡ 충전소 선택 - 전력 예측 시스템</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/static/css/station_selector.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>⚡ 충전소 선택</h1>
            <p>분석할 100kW 급속충전소를 선택하세요 ({{ total_stations }}개 충전소)</p>
            <div class="quick-info">
                <span class="info-badge">💡 대시보드에서 실시간 분석이 시작됩니다</span>
            </div>
        </div>
        
        <div class="stations-grid">
            {% for station_id, station in stations.items() %}
            <div class="station-card {% if station_id == 'ALL' %}all-stations{% endif %}" 
                 onclick="navigateToStation('{{ station_id }}')">
                <div class="region-badge">{{ station.region }}</div>
                <div class="station-name">{{ station.name }}</div>
                <div class="station-location">📍 {{ station.location }}</div>
                <div class="station-info">
                    <span class="charger-type">⚡ {{ station.charger_type }}</span>
                    <span class="status">✅ {{ station.status }}</span>
                </div>
                <div class="station-actions">
                    <a href="/dashboard/{{ station_id }}" class="btn btn-primary" onclick="event.stopPropagation()">
                        📊 대시보드
                    </a>
                    <a href="/predict/{{ station_id }}" class="btn btn-secondary" onclick="event.stopPropagation()">
                        🔮 빠른 예측
                    </a>
                    <a href="/api/station-analysis/{{ station_id }}" class="btn btn-secondary" onclick="event.stopPropagation()" target="_blank">
                        📈 JSON 보기
                    </a>
                </div>
            </div>
            {% endfor %}
        </div>
        
        <div class="footer">
            <div class="footer-info">
                <div class="info-section">
                    <h3>💡 사용 가이드</h3>
                    <p><strong>대시보드:</strong> 실시간 차트와 상세 분석</p>
                    <p><strong>빠른 예측:</strong> JSON 형태의 즉시 예측 결과</p>
                    <p><strong>전체 분석:</strong> 모든 충전소 통합 데이터 분석</p>
                </div>
                <div class="info-section">
                    <h3>🔧 기능</h3>
                    <p>• 실시간 전력 예측</p>
                    <p>• 월별 계약 권고</p>
                    <p>• 시간대별 패턴 분석</p>
                    <p>• 데이터 시각화</p>
                </div>
            </div>
            <div class="footer-links">
                <a href="/api/docs">📚 API 문서</a> | 
                <a href="/api/stations">📋 충전소 목록 API</a> |
                <a href="/">🏠 시스템 정보</a>
            </div>
        </div>
    </div>
    
    <!-- 로딩 오버레이 -->
    <div id="loading-overlay" class="loading-overlay hidden">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <p>대시보드로 이동 중...</p>
            <small>데이터 분석을 준비하고 있습니다</small>
        </div>
    </div>
    
    <script>
        // 안전한 네비게이션 함수
        function navigateToStation(stationId) {
            showLoadingOverlay();
            
            // 약간의 지연 후 이동 (사용자 피드백)
            setTimeout(() => {
                window.location.href = `/dashboard/${stationId}`;
            }, 500);
        }
        
        function showLoadingOverlay() {
            const overlay = document.getElementById('loading-overlay');
            if (overlay) {
                overlay.classList.remove('hidden');
            }
        }
        
        // 뒤로가기 시 로딩 오버레이 숨김
        window.addEventListener('pageshow', function() {
            const overlay = document.getElementById('loading-overlay');
            if (overlay) {
                overlay.classList.add('hidden');
            }
        });
    </script>
    
    <script src="/static/js/station_selector.js"></script>
</body>
</html>